<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>service.packages.PackageManager</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="https://github.com/JiscPER/jper">Jisc Publications Router</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="service-module.html">Package&nbsp;service</a> ::
        <a href="service.packages-module.html">Module&nbsp;packages</a> ::
        Class&nbsp;PackageManager
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="service.packages.PackageManager-class.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class PackageManager</h1><p class="nomargin-top"><span class="codelink"><a href="service.packages-pysrc.html#PackageManager">source&nbsp;code</a></span></p>
<center>
<center>  <map id="uml_class_diagram_for_service__48" name="uml_class_diagram_for_service__48">
<area shape="rect" id="node1_3" href="service.packages.PackageManager-class.html#ingest" title="Ingest into the storage system the supplied package, of the specified format, with the specified store_id." alt="" coords="17,37,535,57"/>
<area shape="rect" id="node1_4" href="service.packages.PackageManager-class.html#extract" title="Extract notification metadata and match data from the package in the store which has the specified format" alt="" coords="17,57,535,77"/>
<area shape="rect" id="node1_5" href="service.packages.PackageManager-class.html#convert" title="For the package held in the store at the specified store_id, convert the package from the source_format to the target_format." alt="" coords="17,77,535,97"/>
<area shape="rect" id="node1" href="service.packages.PackageManager-class.html" title="Class which provides an API onto the package management system" alt="" coords="5,5,547,104"/>
</map>
  <img src="uml_class_diagram_for_service__48.gif" alt='' usemap="#uml_class_diagram_for_service__48" ismap="ismap" class="graph-without-title" />
</center>
</center>
<hr />
<p>Class which provides an API onto the package management system</p>
<p>If you need to work with packages, the operation you want to do should be covered by one of the
methods on this class.</p>

<!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code>object</code></b>:
      <code>__delattr__</code>,
      <code>__format__</code>,
      <code>__getattribute__</code>,
      <code>__hash__</code>,
      <code>__init__</code>,
      <code>__new__</code>,
      <code>__reduce__</code>,
      <code>__reduce_ex__</code>,
      <code>__repr__</code>,
      <code>__setattr__</code>,
      <code>__sizeof__</code>,
      <code>__str__</code>,
      <code>__subclasshook__</code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== CLASS METHODS ==================== -->
<a name="section-ClassMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Class Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-ClassMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="service.packages.PackageManager-class.html#ingest" class="summary-sig-name">ingest</a>(<span class="summary-sig-arg">cls</span>,
        <span class="summary-sig-arg">store_id</span>,
        <span class="summary-sig-arg">zip_path</span>,
        <span class="summary-sig-arg">format</span>,
        <span class="summary-sig-arg">storage_manager</span>=<span class="summary-sig-default">None</span>)</span><br />
      Ingest into the storage system the supplied package, of the specified format, with the specified store_id.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="service.packages-pysrc.html#PackageManager.ingest">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="service.packages.PackageManager-class.html#extract" class="summary-sig-name">extract</a>(<span class="summary-sig-arg">cls</span>,
        <span class="summary-sig-arg">store_id</span>,
        <span class="summary-sig-arg">format</span>,
        <span class="summary-sig-arg">storage_manager</span>=<span class="summary-sig-default">None</span>)</span><br />
      Extract notification metadata and match data from the package in the store which has the specified format</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="service.packages-pysrc.html#PackageManager.extract">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="service.packages.PackageManager-class.html#convert" class="summary-sig-name">convert</a>(<span class="summary-sig-arg">cls</span>,
        <span class="summary-sig-arg">store_id</span>,
        <span class="summary-sig-arg">source_format</span>,
        <span class="summary-sig-arg">target_formats</span>,
        <span class="summary-sig-arg">storage_manager</span>=<span class="summary-sig-default">None</span>)</span><br />
      For the package held in the store at the specified store_id, convert the package from
the source_format to the target_format.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="service.packages-pysrc.html#PackageManager.convert">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== PROPERTIES ==================== -->
<a name="section-Properties"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Properties</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Properties"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code>object</code></b>:
      <code>__class__</code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Method Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-MethodDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="ingest"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">ingest</span>(<span class="sig-arg">cls</span>,
        <span class="sig-arg">store_id</span>,
        <span class="sig-arg">zip_path</span>,
        <span class="sig-arg">format</span>,
        <span class="sig-arg">storage_manager</span>=<span class="sig-default">None</span>)</span>
    <br /><em class="fname">Class Method</em>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="service.packages-pysrc.html#PackageManager.ingest">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Ingest into the storage system the supplied package, of the specified format, with the specified store_id.</p>
<p>This will attempt to load a PackageHandler for the format around the zip_file.  Then the original
zip file and the metadata files extracted from the package by the PackageHandler will be written
to the storage system with the specified id.</p>
<p>If a storage_manager is provided, that will be used as the interface to the storage system,
otherwise a storage manager will be constructed from the StoreFactory.</p>
<p>Once this method completes, the file held at zip_file will be deleted, and the definitive copy
will be available in the store.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>store_id</code></strong> - the id to use when storing the package</li>
        <li><strong class="pname"><code>zip_path</code></strong> - locally accessible path to the source package on disk</li>
        <li><strong class="pname"><code>format</code></strong> - format identifier for the package handler.  As seen in the configuration.</li>
        <li><strong class="pname"><code>storage_manager</code></strong> - an instance of Store to use as the storage API</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="extract"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">extract</span>(<span class="sig-arg">cls</span>,
        <span class="sig-arg">store_id</span>,
        <span class="sig-arg">format</span>,
        <span class="sig-arg">storage_manager</span>=<span class="sig-default">None</span>)</span>
    <br /><em class="fname">Class Method</em>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="service.packages-pysrc.html#PackageManager.extract">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Extract notification metadata and match data from the package in the store which has the specified format</p>
<p>This will look in the store for the store_id, and look for files which match the known metadata file
names from the PackageHandler which is referenced by the format.  Once those files are found, they are loaded
into the PackageHandler and the metadata and match data extracted and returned.</p>
<p>If a storage_manager is provided, that will be used as the interface to the storage system,
otherwise a storage manager will be constructed from the StoreFactory.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>store_id</code></strong> - the storage id where this object can be found</li>
        <li><strong class="pname"><code>format</code></strong> - format identifier for the package handler.  As seen in the configuration.</li>
        <li><strong class="pname"><code>storage_manager</code></strong> - an instance of Store to use as the storage API</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>a tuple of (NotificationMetadata, RoutingMetadata) representing the metadata stored in the package</dd>
  </dl>
</td></tr></table>
</div>
<a name="convert"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">convert</span>(<span class="sig-arg">cls</span>,
        <span class="sig-arg">store_id</span>,
        <span class="sig-arg">source_format</span>,
        <span class="sig-arg">target_formats</span>,
        <span class="sig-arg">storage_manager</span>=<span class="sig-default">None</span>)</span>
    <br /><em class="fname">Class Method</em>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="service.packages-pysrc.html#PackageManager.convert">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>For the package held in the store at the specified store_id, convert the package from
the source_format to the target_format.</p>
<p>This will make a local copy of the source package from the storage system, make all
the relevant conversions (also locally), and then synchronise back to the store.</p>
<p>If a storage_manager is provided, that will be used as the interface to the storage system,
otherwise a storage manager will be constructed from the StoreFactory.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>store_id</code></strong> - the storage id where this object can be found</li>
        <li><strong class="pname"><code>source_format</code></strong> - format identifier for the input package handler.  As seen in the configuration.</li>
        <li><strong class="pname"><code>target_format</code></strong> - format identifier for the output package handler.  As seen in the configuration.</li>
        <li><strong class="pname"><code>storage_manager</code></strong> - an instance of Store to use as the storage API</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>a list of tuples of the conversions carried out of the form [(format, filename, url name)]</dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="https://github.com/JiscPER/jper">Jisc Publications Router</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Fri Jan 22 11:50:51 2021
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
